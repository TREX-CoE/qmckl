<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-12-15 Mon 15:30 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Error handling</title>
<meta name="author" content="TREX CoE" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" title="Standard" href="qmckl.css" type="text/css" />

<script src="org-info.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script>
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
org_html_manager.set("TOC_DEPTH", "4");
org_html_manager.set("LINK_HOME", "index.html");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">Error handling</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgcbf6c2c">-</a>
<ul>
<li><a href="#org011ce22">Exit codes</a></li>
<li><a href="#org5758b5c">String conversion</a></li>
</ul>
</li>
<li><a href="#orgddc3a56">1. Decoding errors</a></li>
<li><a href="#org3c583fb">2. Data structure in context</a></li>
<li><a href="#orgae7aae0">3. Updating errors in the context</a></li>
<li><a href="#org57c06c5">4. Get the error</a></li>
<li><a href="#org3c70c29">5. Failing</a></li>
<li><a href="#orgfdddb79">6. Last error</a></li>
<li><a href="#org117d8ec">7. Helper functions for debugging</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgcbf6c2c" class="outline-2">
<h2 id="orgcbf6c2c">-</h2>
<div class="outline-text-2" id="text-orgcbf6c2c">
<p>
The QMCkl library implements a robust error handling mechanism to ensure
that errors are properly communicated to the calling program without causing
unexpected termination. The library adheres to the principle that library code
should never make the calling programs abort, nor perform any input/output
operations. This decision has to be taken by the developer of the code calling
the library, allowing for better integration with diverse software environments
and error recovery strategies.
</p>
</div>

<div id="outline-container-org011ce22" class="outline-3">
<h3 id="org011ce22">Exit codes</h3>
<div class="outline-text-3" id="text-org011ce22">
<p>
All the functions in the QMCkl library return with an exit code, defined as
</p>
<div class="org-src-container">
<pre class="src src-c" id="orgd19cb10"><span style="color: #a020f0;">typedef</span> <span style="color: #228b22;">int32_t</span> <span style="color: #228b22;">qmckl_exit_code</span>;
</pre>
</div>


<p>
The exit code provides a standardized way to return the completion status 
of a function to the calling program. When a function call completes 
successfully, <code>QMCKL_SUCCESS</code> (value 0) is returned. If one of the functions 
of the library fails to complete the requested task, an appropriate error 
code is returned to the program.
</p>

<p>
This approach allows calling programs to check the return value and handle 
errors appropriately, implementing their own error recovery strategies or 
logging mechanisms. The error codes are designed to be self-documenting,
with specific codes for common error conditions such as invalid arguments,
allocation failures, and context-related issues.
</p>

<p>
Here is the complete list of exit codes:
</p>

<table id="org2870586" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Macro</th>
<th scope="col" class="org-right">Code</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>QMCKL_SUCCESS</code></td>
<td class="org-right">0</td>
<td class="org-left">'Success'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_1</code></td>
<td class="org-right">1</td>
<td class="org-left">'Invalid argument 1'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_2</code></td>
<td class="org-right">2</td>
<td class="org-left">'Invalid argument 2'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_3</code></td>
<td class="org-right">3</td>
<td class="org-left">'Invalid argument 3'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_4</code></td>
<td class="org-right">4</td>
<td class="org-left">'Invalid argument 4'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_5</code></td>
<td class="org-right">5</td>
<td class="org-left">'Invalid argument 5'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_6</code></td>
<td class="org-right">6</td>
<td class="org-left">'Invalid argument 6'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_7</code></td>
<td class="org-right">7</td>
<td class="org-left">'Invalid argument 7'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_8</code></td>
<td class="org-right">8</td>
<td class="org-left">'Invalid argument 8'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_9</code></td>
<td class="org-right">9</td>
<td class="org-left">'Invalid argument 9'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_10</code></td>
<td class="org-right">10</td>
<td class="org-left">'Invalid argument 10'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_11</code></td>
<td class="org-right">11</td>
<td class="org-left">'Invalid argument 11'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_12</code></td>
<td class="org-right">12</td>
<td class="org-left">'Invalid argument 12'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_13</code></td>
<td class="org-right">13</td>
<td class="org-left">'Invalid argument 13'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_14</code></td>
<td class="org-right">14</td>
<td class="org-left">'Invalid argument 14'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_15</code></td>
<td class="org-right">15</td>
<td class="org-left">'Invalid argument 15'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_16</code></td>
<td class="org-right">16</td>
<td class="org-left">'Invalid argument 16'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_17</code></td>
<td class="org-right">17</td>
<td class="org-left">'Invalid argument 17'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_18</code></td>
<td class="org-right">18</td>
<td class="org-left">'Invalid argument 18'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_19</code></td>
<td class="org-right">19</td>
<td class="org-left">'Invalid argument 19'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_ARG_20</code></td>
<td class="org-right">20</td>
<td class="org-left">'Invalid argument 20'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_FAILURE</code></td>
<td class="org-right">101</td>
<td class="org-left">'Failure'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_ERRNO</code></td>
<td class="org-right">102</td>
<td class="org-left">strerror(errno)</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_CONTEXT</code></td>
<td class="org-right">103</td>
<td class="org-left">'Invalid context'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_ALLOCATION_FAILED</code></td>
<td class="org-right">104</td>
<td class="org-left">'Allocation failed'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_DEALLOCATION_FAILED</code></td>
<td class="org-right">105</td>
<td class="org-left">'De-allocation failed'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_NOT_PROVIDED</code></td>
<td class="org-right">106</td>
<td class="org-left">'Not provided'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_OUT_OF_BOUNDS</code></td>
<td class="org-right">107</td>
<td class="org-left">'Index out of bounds'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_ALREADY_SET</code></td>
<td class="org-right">108</td>
<td class="org-left">'Already set'</td>
</tr>

<tr>
<td class="org-left"><code>QMCKL_INVALID_EXIT_CODE</code></td>
<td class="org-right">109</td>
<td class="org-left">'Invalid exit code'</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org5758b5c" class="outline-3">
<h3 id="org5758b5c">String conversion</h3>
<div class="outline-text-3" id="text-org5758b5c">
<p>
The <code>qmckl_string_of_error</code> function converts an exit code into a human-readable
string representation. This is useful for logging and error reporting purposes.
The string is assumed to be large enough to contain the error message
(typically 128 characters).
</p>
</div>
</div>
</div>

<div id="outline-container-orgddc3a56" class="outline-2">
<h2 id="orgddc3a56"><span class="section-number-2">1.</span> Decoding errors</h2>
<div class="outline-text-2" id="text-1">
<p>
To facilitate debugging and error reporting, QMCkl provides the 
<code>qmckl_string_of_error</code> function which converts an error code into 
a descriptive string. This allows applications to present meaningful 
error messages to users or write detailed logs for troubleshooting.
</p>

<p>
The function takes an error code as input and returns a constant string
describing the error condition. Both C and Fortran interfaces are provided
for maximum compatibility.
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #a020f0;">const</span> <span style="color: #228b22;">char</span>*
<span style="color: #0000ff;">qmckl_string_of_error</span> (<span style="color: #a020f0;">const</span> <span style="color: #228b22;">qmckl_exit_code</span> <span style="color: #a0522d;">error</span>);
</pre>
</div>

<p>
The text strings returned by this function are extracted from the error codes
table defined earlier. This ensures consistency between the error codes and
their string representations throughout the library.
</p>
</div>
</div>
<div id="outline-container-org3c583fb" class="outline-2">
<h2 id="org3c583fb"><span class="section-number-2">2.</span> Data structure in context</h2>
<div class="outline-text-2" id="text-2">
<p>
The QMCkl context maintains detailed error state information through a
dedicated data structure. This structure stores not only the error code,
but also the name of the function where the error occurred and a descriptive
message explaining the error condition.
</p>

<p>
The strings are declared internally with a maximum fixed size to avoid
dynamic memory allocation, which is important for performance and thread
safety. This design choice ensures that error handling itself does not
introduce additional failure modes or performance bottlenecks.
</p>
</div>
</div>

<div id="outline-container-orgae7aae0" class="outline-2">
<h2 id="orgae7aae0"><span class="section-number-2">3.</span> Updating errors in the context</h2>
<div class="outline-text-2" id="text-3">
<p>
The error state in the context is updated using the <code>qmckl_set_error</code>
function. This function provides a centralized mechanism for recording
errors that occur during library operations.
</p>

<p>
When an error is set in the context, it is mandatory to specify
from which function the error is triggered, and a message
explaining the error. The exit code can't be <code>QMCKL_SUCCESS</code>.
</p>

<p>
This detailed error information enables precise debugging and helps
users understand exactly what went wrong and where, making it easier
to diagnose and fix issues in code using the QMCkl library.
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">qmckl_exit_code</span>
<span style="color: #0000ff;">qmckl_set_error</span>(<span style="color: #228b22;">qmckl_context</span> <span style="color: #a0522d;">context</span>,
                <span style="color: #a020f0;">const</span> <span style="color: #228b22;">qmckl_exit_code</span> <span style="color: #a0522d;">exit_code</span>,
                <span style="color: #a020f0;">const</span> <span style="color: #228b22;">char</span>* <span style="color: #a0522d;">function_name</span>,
                <span style="color: #a020f0;">const</span> <span style="color: #228b22;">char</span>* <span style="color: #a0522d;">message</span>);
</pre>
</div>
</div>
</div>
<div id="outline-container-org57c06c5" class="outline-2">
<h2 id="org57c06c5"><span class="section-number-2">4.</span> Get the error</h2>
<div class="outline-text-2" id="text-4">
<p>
Upon error, the calling program can retrieve detailed error information from the
context using <code>qmckl_get_error</code>. This function provides access to the error 
code, the name of the function where the error occurred, and a descriptive 
message explaining the error condition.
</p>

<p>
The error message and function name are returned in the variables provided 
by the caller. Therefore, passing valid pointers for the function name and 
message is mandatory. The caller must ensure that the provided buffers are
large enough to hold the error information.
</p>

<p>
This retrieval mechanism allows applications to implement sophisticated error
handling strategies, such as retry logic, fallback mechanisms, or detailed
logging for post-mortem analysis.
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">qmckl_exit_code</span>
<span style="color: #0000ff;">qmckl_get_error</span>(<span style="color: #228b22;">qmckl_context</span> <span style="color: #a0522d;">context</span>,
                <span style="color: #228b22;">qmckl_exit_code</span> *<span style="color: #a0522d;">exit_code</span>,
                <span style="color: #228b22;">char</span>* <span style="color: #a0522d;">function_name</span>,
                <span style="color: #228b22;">char</span>* <span style="color: #a0522d;">message</span>);
</pre>
</div>
</div>
</div>
<div id="outline-container-org3c70c29" class="outline-2">
<h2 id="org3c70c29"><span class="section-number-2">5.</span> Failing</h2>
<div class="outline-text-2" id="text-5">
<p>
To make a function fail, the <code>qmckl_failwith</code> function should be
called, such that information about the failure is stored in
the context. The desired exit code is given as an argument, as
well as the name of the function and an error message. If the
message is <code>NULL</code>, then the default message obtained by
<code>qmckl_string_of_error</code> is used. The return code of the function is
the desired return code.
Upon failure, a <code>QMCKL_NULL_CONTEXT</code> is returned.
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">qmckl_exit_code</span>
<span style="color: #0000ff;">qmckl_failwith</span>(<span style="color: #228b22;">qmckl_context</span> <span style="color: #a0522d;">context</span>,
               <span style="color: #a020f0;">const</span> <span style="color: #228b22;">qmckl_exit_code</span> <span style="color: #a0522d;">exit_code</span>,
               <span style="color: #a020f0;">const</span> <span style="color: #228b22;">char</span>* <span style="color: #a0522d;">function</span>,
               <span style="color: #a020f0;">const</span> <span style="color: #228b22;">char</span>* <span style="color: #a0522d;">message</span>) ;
</pre>
</div>

<p>
For example, this function can be used as
</p>
<div class="org-src-container">
<pre class="src src-c"><span style="color: #a020f0;">if</span> (x &lt; 0) {
  <span style="color: #a020f0;">return</span> qmckl_failwith(context,
                        QMCKL_INVALID_ARG_2,
                        <span style="color: #8b2252;">"qmckl_function"</span>,
                        <span style="color: #8b2252;">"Expected x &gt;= 0"</span>);
 }
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfdddb79" class="outline-2">
<h2 id="orgfdddb79"><span class="section-number-2">6.</span> Last error</h2>
<div class="outline-text-2" id="text-6">
<p>
Returns a string describing the last error, using <code>qmckl_get_error</code>.
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">qmckl_exit_code</span>
<span style="color: #0000ff;">qmckl_last_error</span>(<span style="color: #228b22;">qmckl_context</span> <span style="color: #a0522d;">context</span>, <span style="color: #228b22;">char</span>* <span style="color: #a0522d;">buffer</span>);
</pre>
</div>
</div>
</div>

<div id="outline-container-org117d8ec" class="outline-2">
<h2 id="org117d8ec"><span class="section-number-2">7.</span> Helper functions for debugging</h2>
<div class="outline-text-2" id="text-7">
<p>
The following function prints to <code>stderr</code> an error message is the return code is
not <code>QMCKL_SUCCESS</code>.
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">qmckl_exit_code</span>
<span style="color: #0000ff;">qmckl_check</span>(<span style="color: #228b22;">qmckl_context</span> <span style="color: #a0522d;">context</span>, <span style="color: #228b22;">qmckl_exit_code</span> <span style="color: #a0522d;">rc</span>);
</pre>
</div>

<p>
It should be used as:
</p>

<div class="org-src-container">
<pre class="src src-c">rc = qmckl_check(context,
                 qmckl_...(context, ...)
                 );
<span style="color: #0000ff;">assert</span> (rc == QMCKL_SUCCESS);
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: TREX CoE</p>
<p class="date">Created: 2025-12-15 Mon 15:30</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
