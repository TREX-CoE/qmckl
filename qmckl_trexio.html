<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-12-15 Mon 15:28 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TREXIO I/O library</title>
<meta name="author" content="TREX CoE" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" title="Standard" href="qmckl.css" type="text/css" />

<script src="org-info.js">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
// @license-end
</script>

<script>
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
org_html_manager.set("TOC_DEPTH", "4");
org_html_manager.set("LINK_HOME", "index.html");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="content" class="content">
<h1 class="title">TREXIO I/O library</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org8b91535">1. Local functions</a>
<ul>
<li><a href="#org68458f6">1.1. Open file</a></li>
<li><a href="#org6f83ae0">1.2. Electron</a></li>
<li><a href="#orgfc491fb">1.3. Nucleus</a>
<ul>
<li><a href="#orge5ec91a">1.3.1. Number of nuclei</a></li>
<li><a href="#orgc1f0cd8">1.3.2. Nuclear charges</a></li>
<li><a href="#org8c542e5">1.3.3. Nuclear coordinates</a></li>
</ul>
</li>
<li><a href="#orgdea2576">1.4. Basis set and AOs</a>
<ul>
<li><a href="#org032cf73">1.4.1. Basis set type</a></li>
<li><a href="#org12e91d0">1.4.2. Number of shells</a></li>
<li><a href="#org653489c">1.4.3. Number of primitives</a></li>
<li><a href="#org6f936fc">1.4.4. Number of atomic orbitals</a></li>
<li><a href="#org49c2693">1.4.5. Nucleus<sub>index</sub> array</a></li>
<li><a href="#orgf798f4a">1.4.6. Number of shells per nucleus</a></li>
<li><a href="#org37b44db">1.4.7. r power</a></li>
<li><a href="#org9596c66">1.4.8. Angular momentum</a></li>
<li><a href="#org2d9fffa">1.4.9. Number of primitives per shell</a></li>
<li><a href="#org27d1b5b">1.4.10. Indices of the primitives</a></li>
<li><a href="#org11fdd04">1.4.11. Normalization of the shells</a></li>
<li><a href="#orgd3c4518">1.4.12. Exponents</a></li>
<li><a href="#org2514735">1.4.13. Coefficients</a></li>
<li><a href="#org778acdb">1.4.14. Normalization of the primitivies</a></li>
<li><a href="#org9ddb2f2">1.4.15. AO Normalization</a></li>
</ul>
</li>
<li><a href="#orgb1e5939">1.5. Molecular orbitals</a>
<ul>
<li><a href="#org2a63aab">1.5.1. Number of MOs</a></li>
<li><a href="#org6c147e9">1.5.2. MO coefficients</a></li>
</ul>
</li>
<li><a href="#orgcee103a">1.6. <span class="todo TODO">TODO</span> ECP</a></li>
</ul>
</li>
<li><a href="#org50eec74">2. Read everything</a></li>
<li><a href="#org56edfbe">3. Test</a>
<ul>
<li>
<ul>
<li><a href="#org7fc12fa">3.0.1. Electrons</a></li>
<li><a href="#org53f7aec">3.0.2. Nuclei</a></li>
<li><a href="#orge86574e">3.0.3. Atomic basis</a></li>
<li><a href="#org3841ff0">3.0.4. MO Basis</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org8b91535" class="outline-2">
<h2 id="org8b91535"><span class="section-number-2">1.</span> Local functions</h2>
<div class="outline-text-2" id="text-1">
<p>
Functions defined in this section are all local (internal to this module):
they should not be exposed in the public API. To identify them clearly,
we append <code>_X</code> to their name, indicating their private status.
</p>

<p>
Users are not able to call these functions directly. Since they are only
called from within this module where the context validity has already been
checked, the context parameter can't be <code>NULL</code>. Therefore, we verify this
precondition with an <code>assert</code> statement rather than returning an error code.
</p>

<p>
In the functions defined in this section, we use the following local variable
naming conventions:
</p>
<ul class="org-ul">
<li><code>rc</code>: the return code for QMCkl functions</li>
<li><code>rcio</code>: the return code for TREXIO library functions.</li>
</ul>
</div>

<div id="outline-container-org68458f6" class="outline-3">
<h3 id="org68458f6"><span class="section-number-3">1.1.</span> Open file</h3>
<div class="outline-text-3" id="text-1-1">
<p>
We first define a helper function to open a TREXIO file by attempting
multiple backends. It tries to use the TEXT backend first, and if that fails,
attempts the HDF5 backend. If both strategies fail, a <code>NULL</code> pointer is 
returned. This flexible approach allows the function to handle TREXIO files
in either format without requiring the user to specify which format is used.
open only once the file and call multiple small functions to read
groups of data by passing the <code>trexio_t</code> handle.
</p>
</div>
</div>

<div id="outline-container-org6f83ae0" class="outline-3">
<h3 id="org6f83ae0"><span class="section-number-3">1.2.</span> Electron</h3>
<div class="outline-text-3" id="text-1-2">
<p>
In this section we read all the data into the electron data structure.
We read the number of up-spin and down-spin electrons.
</p>
</div>
</div>

<div id="outline-container-orgfc491fb" class="outline-3">
<h3 id="orgfc491fb"><span class="section-number-3">1.3.</span> Nucleus</h3>
<div class="outline-text-3" id="text-1-3">
<p>
In this section we read the number of nuclei, the molecular geometry and nuclear charges.
</p>
</div>

<div id="outline-container-orge5ec91a" class="outline-4">
<h4 id="orge5ec91a"><span class="section-number-4">1.3.1.</span> Number of nuclei</h4>
</div>

<div id="outline-container-orgc1f0cd8" class="outline-4">
<h4 id="orgc1f0cd8"><span class="section-number-4">1.3.2.</span> Nuclear charges</h4>
</div>

<div id="outline-container-org8c542e5" class="outline-4">
<h4 id="org8c542e5"><span class="section-number-4">1.3.3.</span> Nuclear coordinates</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
Now, we read the molecular geometry. It is stored in normal format
in the TREXIO file (<code>'N'</code>), so it will be automatically transposed internally.
</p>
</div>
</div>
</div>

<div id="outline-container-orgdea2576" class="outline-3">
<h3 id="orgdea2576"><span class="section-number-3">1.4.</span> Basis set and AOs</h3>
<div class="outline-text-3" id="text-1-4">
<p>
In this section we read the atomic basis set and atomic orbitals.
</p>
</div>

<div id="outline-container-org032cf73" class="outline-4">
<h4 id="org032cf73"><span class="section-number-4">1.4.1.</span> Basis set type</h4>
</div>

<div id="outline-container-org12e91d0" class="outline-4">
<h4 id="org12e91d0"><span class="section-number-4">1.4.2.</span> Number of shells</h4>
</div>

<div id="outline-container-org653489c" class="outline-4">
<h4 id="org653489c"><span class="section-number-4">1.4.3.</span> Number of primitives</h4>
</div>

<div id="outline-container-org6f936fc" class="outline-4">
<h4 id="org6f936fc"><span class="section-number-4">1.4.4.</span> Number of atomic orbitals</h4>
</div>

<div id="outline-container-org49c2693" class="outline-4">
<h4 id="org49c2693"><span class="section-number-4">1.4.5.</span> Nucleus<sub>index</sub> array</h4>
</div>

<div id="outline-container-orgf798f4a" class="outline-4">
<h4 id="orgf798f4a"><span class="section-number-4">1.4.6.</span> Number of shells per nucleus</h4>
</div>

<div id="outline-container-org37b44db" class="outline-4">
<h4 id="org37b44db"><span class="section-number-4">1.4.7.</span> r power</h4>
<div class="outline-text-4" id="text-1-4-7">
<div class="org-src-container">
<pre class="src src-c">{
  <span style="color: #228b22;">qmckl_memory_info_struct</span> <span style="color: #a0522d;">mem_info</span> = qmckl_memory_info_struct_zero;

  /* <span style="color: #b22222;">Allocate array for data</span> */
  mem_info.size = shell_num * <span style="color: #a020f0;">sizeof</span>(int32_t);

  <span style="color: #228b22;">int32_t</span>* <span style="color: #a0522d;">r_power</span> = (<span style="color: #228b22;">int32_t</span>*) qmckl_malloc(context, mem_info);

  <span style="color: #a020f0;">if</span> (r_power == <span style="color: #008b8b;">NULL</span>) {
    <span style="color: #a020f0;">return</span> qmckl_failwith( context,
                           QMCKL_ALLOCATION_FAILED,
                           <span style="color: #8b2252;">"qmckl_trexio_read_basis_r_power"</span>,
                           <span style="color: #008b8b;">NULL</span>);
  }

  assert (r_power != <span style="color: #008b8b;">NULL</span>);

  /* <span style="color: #b22222;">Read data</span> */
  rcio = trexio_read_safe_basis_r_power_32(file, r_power, shell_num);
  <span style="color: #a020f0;">if</span> (rcio != TREXIO_SUCCESS) {
    <span style="color: #a020f0;">for</span> (<span style="color: #228b22;">int</span> <span style="color: #a0522d;">i</span>=0 ; i&lt;shell_num ; ++i) {
      r_power[i] = 0;
    }
  }

  /* <span style="color: #b22222;">Store data</span> */
  rc = qmckl_set_ao_basis_r_power(context, r_power, shell_num);

  qmckl_free(context, r_power);
  r_power = <span style="color: #008b8b;">NULL</span>;

  <span style="color: #a020f0;">if</span> (rc != QMCKL_SUCCESS)
    <span style="color: #a020f0;">return</span> rc;
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org9596c66" class="outline-4">
<h4 id="org9596c66"><span class="section-number-4">1.4.8.</span> Angular momentum</h4>
</div>

<div id="outline-container-org2d9fffa" class="outline-4">
<h4 id="org2d9fffa"><span class="section-number-4">1.4.9.</span> Number of primitives per shell</h4>
</div>

<div id="outline-container-org27d1b5b" class="outline-4">
<h4 id="org27d1b5b"><span class="section-number-4">1.4.10.</span> Indices of the primitives</h4>
</div>

<div id="outline-container-org11fdd04" class="outline-4">
<h4 id="org11fdd04"><span class="section-number-4">1.4.11.</span> Normalization of the shells</h4>
</div>

<div id="outline-container-orgd3c4518" class="outline-4">
<h4 id="orgd3c4518"><span class="section-number-4">1.4.12.</span> Exponents</h4>
</div>

<div id="outline-container-org2514735" class="outline-4">
<h4 id="org2514735"><span class="section-number-4">1.4.13.</span> Coefficients</h4>
</div>

<div id="outline-container-org778acdb" class="outline-4">
<h4 id="org778acdb"><span class="section-number-4">1.4.14.</span> Normalization of the primitivies</h4>
</div>

<div id="outline-container-org9ddb2f2" class="outline-4">
<h4 id="org9ddb2f2"><span class="section-number-4">1.4.15.</span> AO Normalization</h4>
</div>
</div>
<div id="outline-container-orgb1e5939" class="outline-3">
<h3 id="orgb1e5939"><span class="section-number-3">1.5.</span> Molecular orbitals</h3>
<div class="outline-text-3" id="text-1-5">
<p>
In this section we read the MO coefficients.
</p>
</div>

<div id="outline-container-org2a63aab" class="outline-4">
<h4 id="org2a63aab"><span class="section-number-4">1.5.1.</span> Number of MOs</h4>
</div>

<div id="outline-container-org6c147e9" class="outline-4">
<h4 id="org6c147e9"><span class="section-number-4">1.5.2.</span> MO coefficients</h4>
</div>
</div>

<div id="outline-container-orgcee103a" class="outline-3">
<h3 id="orgcee103a"><span class="section-number-3">1.6.</span> <span class="todo TODO">TODO</span> ECP</h3>
</div>
</div>
<div id="outline-container-org50eec74" class="outline-2">
<h2 id="org50eec74"><span class="section-number-2">2.</span> Read everything</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre class="src src-c"><span style="color: #228b22;">qmckl_exit_code</span>
<span style="color: #0000ff;">qmckl_trexio_read</span>(<span style="color: #a020f0;">const</span> <span style="color: #228b22;">qmckl_context</span> <span style="color: #a0522d;">context</span>,
                  <span style="color: #a020f0;">const</span> <span style="color: #228b22;">char</span>* <span style="color: #a0522d;">file_name</span>,
                  <span style="color: #a020f0;">const</span> <span style="color: #228b22;">int64_t</span> <span style="color: #a0522d;">size_max</span>);
</pre>
</div>
</div>
</div>

<div id="outline-container-org56edfbe" class="outline-2">
<h2 id="org56edfbe"><span class="section-number-2">3.</span> Test</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org7fc12fa" class="outline-4">
<h4 id="org7fc12fa"><span class="section-number-4">3.0.1.</span> Electrons</h4>
</div>

<div id="outline-container-org53f7aec" class="outline-4">
<h4 id="org53f7aec"><span class="section-number-4">3.0.2.</span> Nuclei</h4>
</div>

<div id="outline-container-orge86574e" class="outline-4">
<h4 id="orge86574e"><span class="section-number-4">3.0.3.</span> Atomic basis</h4>
</div>

<div id="outline-container-org3841ff0" class="outline-4">
<h4 id="org3841ff0"><span class="section-number-4">3.0.4.</span> MO Basis</h4>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: TREX CoE</p>
<p class="date">Created: 2025-12-15 Mon 15:28</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
